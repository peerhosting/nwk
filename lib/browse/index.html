<!DOCTYPE html>
<html>
  <head>
    <title>host</title>
    <link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
    <!-- jQuery -->
    <script src="http://code.jquery.com/jquery.js"></script>
    <!-- Bootstrap JavaScript -->
    <script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
    <style type="text/css">
    .magnet {

    }
    .magnet:hover {
      color: white;
      background-color: black;
    }
    </style>
  </head>
  <body>
  <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <a class="navbar-brand" href="/">colony</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="/browse">browse</a>
      </li>
      <li>
        <a href="/upload">upload</a>
      </li>
    </ul>
  </nav>
    <div class="jumbotron">
      <div class="container">
      <div>
         <h1>Active Sites</h1>
        <div class="well" id="magLinkCon"> 
        </div>
      </div>
        
        

      </div>
    </div>

    

  </body>

  <script type="text/javascript">

  $(document).ready(function(){ 

      $.ajax({
        url: '/magnetURI', 
        type: 'get', 
        success: function(data){
          var mag = JSON.parse(data);
          console.log(mag);
          var newLink;
          var newHTML = '';
          jQuery.each(mag, function(key, val) {
            console.log(val);
            
            var k = Object.keys(val)[0];
            console.log(k);
            console.log(val[k]);
            var temp = '<p>Name :' + k + ' maglink: <small> <span class="magnet">';
            temp += val[k] + '</span>';
            temp += '<small></p>';

            newHTML += temp;

          });

          $('#magLinkCon').append(newHTML);
          
        }
      });



    $("#magLinkCon").on('click', 'span.magnet', function() {
        console.log($(this).text());
        var magLink = $(this).text();
        var mag = {
          'mag' : magLink
        }

       $.ajax({
         url: '/browse', 
         type: 'post', 
         data: mag,
         success: function(data){
          console.log(data);
          window.location.href = data;
         }
       });

    });
      
      
  });
  

  </script>
</html>