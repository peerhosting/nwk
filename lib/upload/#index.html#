<!DOCTYPE html>
<html>
  <head>
    <title>host</title>
    <link href="https://netdna.bootstrapcdn.com/bootstrap/3.1.1/css/bootstrap.min.css" rel="stylesheet">
    <!-- jQuery -->
    <script src="http://code.jquery.com/jquery.js"></script>
    <!-- Bootstrap JavaScript -->
    <script src="http://netdna.bootstrapcdn.com/bootstrap/3.1.1/js/bootstrap.min.js"></script>
   <!--  <script src="/lib/upload/js/controller.js"></script>
    <script src="nwk/lib/upload/js/controller.js"></script> -->

    <style>


      #filedrag
      {
        display: none;
        font-weight: bold;
        text-align: center;
        padding: 1em 0;
        margin: 1em 0;
        color: #555;
        border: 2px dashed #555;
        border-radius: 7px;
        cursor: default;
      }

      #filedrag.hover
      {
        color: #f00;
        border-color: #f00;
        border-style: solid;
        box-shadow: inset 0 3px 4px #888;
      }
      .btn-file {
          position: relative;
          overflow: hidden;
      }
      .btn-file input[type=file] {
          position: absolute;
          top: 0;
          right: 0;
          min-width: 100%;
          min-height: 100%;
          font-size: 100px;
          text-align: right;
          filter: alpha(opacity=0);
          opacity: 0;
          outline: none;
          background: white;
          cursor: inherit;
          display: block;
      }


    </style>

  </head>
  <body>
  <nav class="navbar navbar-default navbar-fixed-top" role="navigation">
    <a class="navbar-brand" href="/">colony</a>
    <ul class="nav navbar-nav">
      <li>
        <a href="/browse">browse</a>
      </li>
      <li>
        <a href="/upload">upload</a>
      </li>
    </ul>
  </nav>


    <hr> 

    <div class="jumbotron">

      <div class="container">



        <div class="col-xs-3 col-sm-3 col-md-3 col-lg-3"> </div>
          
           
        <div class="col-xs-6 col-sm-6 col-md-6 col-lg-6 text-center input-group ">



          <form id = "uploadFile" enctype="multipart/form-data" action="/fileupload" method="post">

            <div class="form-group">
               <h2>Website Name</h2>
               <input type="text" class="form-control" id="name" placeholder="My Website">
             </div>
             <br>
             <br>
             <br>
             <span class="btn btn-default btn-file">
                 Browse <input type="file", name="file", id="files" multiple/>
             </span>
             <br>
             <br>

            <div id="selectedFiles"></div>

            <br>
            <br>
            
          
            <input id="upload" class="btn btn-file" type="submit" value="Upload">  

          </form>


        </div>

        <div class="col-xs-3 col-sm-3 col-md-3 col-lg-3"> </div>

      </div>
    </div>


  </body>
  <script>
  
  $(document).ready(function(){

    var selDiv = "";
        

    

    function init() {
      document.querySelector('#files').addEventListener('change', handleFileSelect, false);
      selDiv = document.querySelector("#selectedFiles");
    }
    init();

    function handleFileSelect(e) {
     
        
        if(!e.target.files) return;
        
        selDiv.innerHTML = "";
        var files = e.target.files;
            var filesArr = Array.prototype.slice.call(files);
            filesArr.forEach(function(f) {

              

              var reader = new FileReader();
              reader.onload = function (e) {
                var html = "<p>" + f.name + "</p>";
                selDiv.innerHTML += html;       
              }
              reader.readAsDataURL(f); 
            });
        
      }

  $('#up').click(function(){
  // if(fifi == null){
  //   console.log('no files');
  //   return;  
  // }
  
  // console.log(typeof fifi);
  // console.log(fifi);
      //var json_data = JSON.stringify(fifi);
    $.when(
  $.ajax({
  url: '/flies', 
  type: 'post',
  data: json_data,
  success: function(data) {
  alert('just came back from the server..');
  
  console.log( data );
  }}),
  $.ajax({
         url: 'cs240-homes.pugetsound.edu:3005',
         data: '{"data": "TEST"}',
        type: 'post',
        jsonpCallback: 'callback', // this is not relevant to the POST anymore
        success: function (data) {
            var ret = jQuery.parseJSON(data);
            $('#name').html(ret.msg);
            console.log('Success: ')
        },
        error: function (xhr, status, error) {
            console.log('Error: ' + error.message);
            $('#name').html('Error connecting to the server.');
        },
      

    })).then( function(){
        console.log("DONE");
    });
});

  });
  </script>
</html>
